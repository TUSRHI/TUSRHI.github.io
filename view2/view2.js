'use strict';

angular.module('myApp.view2', ['ngRoute'])

.config(['$routeProvider', function($routeProvider) {
  $routeProvider.when('/view2', {
    templateUrl: 'view2/view2.html',
    controller: 'View2Ctrl'
  });
}])

.controller('View2Ctrl', [function() {

}])
.controller('GameCtrl',[function(){
  this.gamestate="welcome";
  this.newgame=function(){this.gamestate="ingame";}
  this.isIngame=function(){return (this.gamestate=="ingame");}
  this.isWelcome=function(){return (this.gamestate=="welcome");}

}])
.directive('sudoku',function(){
  return{
    restrict:'E',
    scope:true,
    controllerAs:'sdk',
    templateUrl:'/view2/sudoku.html',
    bindToController:true,
    controller:function(){
      this.seeds=["1.7..6........5.4.8.....2....57............97..9.2..65........6.3.4.1....2.3.....","...6.....9.4.........2..1.8.8....6...1.72.....7...931...3.7......6....95....1....","......52...1..7.....76.49..6............1...2.7..9...4.9..........85.6..4.2.....1",".48...6...1..7.8.......2.......8.76....35....2.......97.39.....9......24.......1.","397.........86..........32.23......5...48....5..9......78.......5....49......42..","7.3....5....6....1..91......5........2.48........7.63......2.9.4.....8..29...1...","...6...3..91.....4...........28........2..1...3....5.98....79..2....68.54....5...",".....914.68....3.......5.........9.87.4.1........7....4......25....58..9..26.....",".....5.7...7.....9..1..7.6..4.....16.3.8..4......9....65......3....1.8.....23....",".9........1...64........56...7.....6..8754..........3....5..1..2.3.9....7...3...9",".9.....3.2....5.8....964.......3..193..........52...........7.5...8.7....69.....4",".......938.......1....67......4.9.....3....7.1.5.......84...9...9.51.6......7.8..",".1......9.32..........8.7.3...478.2...3....5.......84.......47.5....6...4....9...","9....2...1..7...........475..2.9......5....3....14.....4....1.6.28...7.....9.3...",".....9....53..........457........9317..9.4...51.........6....18....2...38...9....","87..2..........9.3....19..59.1.........4..8..3....6....45............1.9...7.1.2.",".28.1...........1.....65..7..2.....1...9....3645.........872...9.....4........37.",".6...2.....31...8........39.....4.2.971.........8.6....2....9..7...8....8...3...1",".5......8...2.3..7.3......5.297.......6...4......4..7....6.8...8.....9..3....21..","43....9...1.5...........3....28.9.........798..7..5........4...7......626...3...5","......64...5.97.......1..........2...1...3..4.7...8...9..6...2.2......618..95....","...78.1......3.6..495...........3...2...61...5......73..76...1..3......4.....4...","...8.2.1....7..24..43..........18..4..2......5.8.....6.3...9.......3........7.6.5",".....1....67..9.....8....67....4...21.....3..9.3...5...2........8.63..........234","24.......1...6........3.......64....9.3.5...4..2...7.1.....985...6..1....7.....3.",".....91...51...2......2..4.76..........94...81....5...9.5........4....53...6....7",".5.3.2....6......4...7....9......9.....89.7..23....8....7...32......4.5.6.8......",".3....7...1...3......7.63......9.5..2......4...96.7....8......15......6....24...8",".....9.14..3....6.2.78........1.3...52......9......6...1..97.....4...7...6....4..",".2..6..9....54......1....37.....4......2....691....8..5.4......7.....65.....8.3..",".......53197.........78.......3...1.3.4....29...8.........71....25...8....6...5..",".1...59...8............64.5.95..........6..32....3..7.7..1...........82.9.62.....","6..85....93..............65...24........3.7.17.2.............7..581..........819.","..3...2.4.7..6.......7.5...3.2.............5....3..89......94.1....26..965.......","9..7.....67....3........7.4...4.3.8.51.9............9...6.....3..1..8.....8.12...","...57..9.8......5.23.............5.4.......82..7.6.....4.1......26...9.....395...","9............7..8...5....96.1...25...8.6.1....7....6..6.....3.4.93.........81....","...59..........43..16.........23..76..51.....8..7.........489..743............2..","......2..9.4.....16...37....3..5.....1...2.7.......32....7..98....8.....2.14.....",".......67...4.8.....2....3....8.76...7...2....4....9..5.3.9........1.8..1..3....2","..5.21...........9..6.....3...3..14.36....7..9..8.......4.....2...1.5.8..5...7...",".....1..35.4..........432.9.......51.89.......7.....8.6..1.....2.....73....89....","..1..9.........3.8...5.1....5......4..86...........8.2....3.17..7..54...62.....5.","....5.2..81..........19.3.....2.7...39........4.....3...5..6....37..8.........574","....7.28.....68....5.....9..68.........91...47.......1...1.6.....6...5.9..4..3...","...1...........1.6.49....7.4.1.2........7......8.1.43.5..4........8..5.9.7......2","4..12....5.6.....8...9....3..2.....6..48..........3.9..3..75....2.....1.......86.","74...1.........26.....38...6.25.....8.3............18.........857......9....2..36",".4.....7..8.9........1.2.6.9.....3.4....5....6...8......4...2.6....169....3..7...",".......64..36.9......7...1......569..1.......34...6.......8...7.95......4...1.8..","......43......5...2.7..4.6.19........2..3.8......189.....1....7...26.....1......5","........6.3....2...4..51.........8.3.57.........548...6.....12.....7..4.7..23....","......8.....9.....124.........17.9....6.3.1....2...4.8...2.5.3......4..649.......","...7.51...3....4..86.2............4.5...7.......1...23........6174........2.58...","..57.8...........3.49...........5..2.8.....4..6.2.7.....2...7..8...2.3.....4.96..","...7.4..6.7......1.....6...19..2.......93.7........5.2..6...38.7.9....5.....8....","......92...8........47..3........17..52.8.........3.4.97......2.2..5...6...49....",".987...........26....31.....62....9.....5..84....7....915.........4..6.......51..","....49..53...8.....1.....72......73..64.........82....6.87.4...7.....2........5..","931.........23..........6..57.....9..9.4...8....5...4......8..24...91.....6.....7","7.2..........4.3.......124.8..92..........1.9.7........3......7124.........2.5..6",".6...9....1...3.2........84..1....6.4..5.......9..1.......5.9.8....2.5...7..4.1..","........2.....6....31....5..7..4........5.91...8.9.3..7....2..43.......56..1.4...","....71....2............41......6...4.3....2.9.81.4....2......9.9..5.3...5.4.....3","...6...........1.8348......65.........3....9....2.9.3.8....4......5..9.67.4...2..","..2..9..1.....6.974.1.........37...........3.18.2.....9...1.....6..9..8.....2.3..",".....6.4.64...5........21......9.3.5..2.....7..85.....5.1.2.......7...8...9....1.","5..............734...861....6.9.7.........2..837.............49...29...61.3......",".....17..2.9.......4...95...3.76.....8.3...........1.7...2.5.........4.28.7....6.","8.7...9.....38....5..6......93.......1...27.6.....4..........65945..........2...4","...2.7..4.4.....5..2.8.......7.3.5....5.7.31.....6...........61498............7..",".5..1....79..5.........893.....61.....8.....22.....3...163........7...9.......8.3","4....9...8.9.....3...3..6.1.1.....4.3..5..........7.5..47..........1.825....9....","....13....6...8....9......123...5...7......451..6...7.......9.....27......3...6.4",".3....1....8...7.4..29.4..........785....1......2.5..........837..85..9.4........",".5....8......92....1....3.....5....4.68.....7...7....17......599.4..1...1...8....","............2..4.3.81.....5....8..........61.43.1...........27...6..5.8.2.7..6...","..8.95..........3......6.5.37.5........4..6..4.......7.95.7.......98......2....16",".5..23...62..............18..2......4.7....8.....61.3.....34.....9...4.7...1.5...","5.....21.....67...1....3...21......9....8..........8.7..735.....39....6....7...2.","..3....74....9....2.9...........7.92.....83..84..........68.......1..28.6.2...1..",".9.5........3...681..8......4..2.8......6.1...7....5..6........5.3.....7...9.1.5.",".....914......8...2......5..5.....36...4......6.8.7...7..1.....8.2...9.4....6...7","...6.3..13.......754.9...........6.........49.5..82.....2....8....3.8...6.9.4....","2..3............625....8..9.2.9.5....9.....7..8...31....7...38...9.........47....",".7.6........34.....9....5..1.6....4....1.5..........63......6.7...9.3..8783......","63........4...2.5.....7..4.7.24..........61.5.............3..79....8...2361......","3..5.7.....9....14...6....8.2..3..........75391.......7.....4......69....5.....6.","3.1.6..........4.5...91.........8.5....4...2.27.....8..5...9...6.3.....1.....26..",".9.78.....35.....9....2...7.........94.....6......9.8...86........1.86..2.3...4..","6.....73....6..1..8.4.......2......8.....3..6..9..2.......5..794.3....2.1...7....","...1..3.7..7.....2..53.........8.14.......6..23...9.....4..5....9.....8..1...2.5.","...1..2.53.1.6......7.8.......3.....7.....54......9.7.........6.2...4..9.19..2...","4....6.........3955....1....9..6...2.2..3.....7.18.......2..8....1...94......4...",".....2.3........72.3.1...........1.5...4.3...7.9..........954...4....6.85.8.2....","...6..7.2..68.....3.4.......1....87..7.94...........9..8....2.6....37..42........","...832.........7...2.....14574.........4...6.......2..9....1.......268..3.....65.","...6..7.....8....4.41......41........6....3.7.7..29...8..........5...94....3.5.1.","58.....3.......42..7.19...........94..26.....8.1.....764....3......7........16...","5....71..2...6.7....4...9.....21.......8....478......1.6........58....9........62"];
      this.answers=["147236958293875641856914273365749812412658397789123465974582136538461729621397584","821657943964138527537294168382541679619723854475869312253976481146382795798415236","864139527931527486257684913629348175345716892178295364596471238713852649482963751","348195672512476893697832451439281765176359248285647139723914586951768324864523917","397241856125863749846597321234176985769485132581932674478629513652318497913754268","713928456542637981869154723957316248326489517184275639638742195471593862295861374","584692731691738254327514698152879463946253187738461529815327946273946815469185372","527389146689421357341765892213546978794812563865973214438197625176258439952634781","893465271467123589521987364748352916936871425215694738652748193379516842184239657","896145327512376498374982561947213856638754912125869734469527183283491675751638249","596182437241375986873964152624738519317659248985241673138426795452897361769513824","621845793857293461439167582278439156943651278165782349584326917792518634316974825","718534269632197584954682713195478326843261957276953841369815472527346198481729635","974532618156784329283619475612398547495276831837145962349827156528461793761953284","647189352953762184182345769264578931738914526519236847396457218475821693821693475","879523614512647983436819275951238746267495831384176592145982367728364159693751428","528719634769348215134265987392457861871926543645183729453872196987631452216594378","568392714293147685147658239685974123971523846432816597324761958719485362856239471","752169348948253617631487295429735861576821439183946572294618753815374926367592184","435287916916543287278691354362879541154326798897415623521764839743958162689132475","198325647635497812724816359486179235519263784372548196947631528253784961861952473","326789145718435692495126837984573261273961458561248973847652319639817524152394786","967842513851763249243951867396518724472396158518427396635189472724635981189274635","439761825267589413518324967856143792172958346943276581321495678784632159695817234","245918673137265948689734512718642395963157284452893761321479856596381427874526139","427539186351864279896127345769218534532946718148375962975483621614792853283651497","954382176763159284182746539876425913415893762239617845547968321391274658628531497","835914726716523894492786315168492537257138649349657182984365271521879463673241958","658379214193245867247816953489163572526784139371952648815497326934621785762538491","428367195397541268651928437276854913843219576915673824534196782789432651162785349","842619753197435286653782194579326418384157629261894375438571962725963841916248537","614325987587941263239876415395712648871469532462538179728154396153697824946283751","624853917935716842187492365513247689849635721762981453291364578458179236376528194","563981274874263915921745683392658147186497352745312896238579461417826539659134728","932764158674851329185239764269473581517986432843125697426597813391648275758312946","164572398879634251235981647382719564691453782457268139943126875526847913718395426","947368152261579483835124796416792538582631947379485621628957314193246875754813269","428593761957816432316427589194235876675189324832764195261348957743952618589671243","173549268954268731628137495732654819419382576865971324346715982597826143281493657","834529167761438259952671438319857624675942381248163975583294716426715893197386542","735921864418563279296784513582379146361452798947816325174638952623195487859247631","927681543534729816816543279462978351189354627375216984658137492291465738743892165","741389625965742318832561947256813794498627531317495862584236179173954286629178453","974853261813762459256194387561237948398415726742689135425976813137548692689321574","631479285492568137857231496168345972523917864749682351285196743376824519914753628","267183954835749126149265873451328697396574218728916435583492761612837549974651382","473128659596347128281956473312794586954862731867513294138675942625489317749231865","749261853138954267265738941612587394893142675457396182324679518576813429981425736","241863579386975142579142863957621384438759621612384795794538216825416937163297458","972851364153649728684723519728435691516298473349176285261584937895367142437912856","956721438431685729287394561198472356725936814643518972869153247574269183312847695","178924536935867214246351978461792853857613492329548761693485127582176349714239685","769543812853921647124786359548172963976438125312659478681295734237814596495367281","429735168731896452865241379216583947543972681987164523358417296174629835692358714","325718469718964253649352187931645872287193546564287931492836715876521394153479628","351794826674258931928316475195827643462935718837641592516472389789163254243589167","567831924138249567294765381349526178752184639816973245973618452421357896685492713","398762415741598263256314978562843791179256384483179526915637842837421659624985137","872149365356287491419536872281465739564973128937821654628754913795318246143692587","931867524685234179742915638574183296193426785268579341319758462427691853856342917","742583961591642378368791245813926754256374189479158632635419827124867593987235416","264789315518463729397215684751894263436572891829631457142356978983127546675948132","896315472547926831231478659973641528462853917158297346789532164314769285625184793","346271985127859436859634172792365814435187269681942357273416598968523741514798623","571698423926743158348152769659431872213875694487269531865924317132587946794316285","672839451358146297491752863529374618746981532183265974934518726267493185815627349","215386749647915238893472156174298365352164897968537421531829674426751983789643512","529734618618529734374861925462917853951348267837652491286175349745293186193486572","358421796279536814146879523931764258785312649462958137694285371513697482827143965","867245913124389657539671428293768541418952736756134289382497165945816372671523894","683257194741693852529841673217938546965472318834165927372589461498716235156324789","853912746794653218621478935537261489148539672269847351916384527385726194472195863","431679582869125473752348691518962347374581269926437158247853916693714825185296734","857913462461528793392467851239745186786139245145682379628354917914276538573891624","634578129958123764172964835321649578596781342847235916215497683763852491489316257","259173846643892715817465392371526984468319527592748631786234159934651278125987463","624573198579218463381694725165487932798352614432169857853941276946725381217836549","238195764567248139914736852376529481859417623421863597195672348643981275782354916","851923674624817395973546218162378549437259186598461732285734961319682457746195823","576948213392167584184523976218475639743689152965231847827356491439812765651794328","153826974468791523279354618536417892927568341841239765715682439394175286682943157","398576241452319768167842395941725836235468179876193524619257483523684917784931652","375629148649518273281743659458291736927436581163857492796184325812375964534962817","298673451361854297547921836174539628823716549956482173732165984415398762689247315","278369514943157862516248739721985643395614278684723195467592381159836427832471956","271658394568349721394721586126837945439165872857492163912584637645973218783216459","637845291948162753215379846752413968483796125196258437824531679579684312361927584","381547629679283514245691378527436891864912753913875246796158432432769185158324967","341265978962783415785914263419328756538476129276591384157639842623847591894152637","192785346735416829684923157826374591947851263351269784418632975579148632263597418","612489735937625184854137692321746958748593216569812347286351479473968521195274863","928154367347968512165327498759286143481573629236419875674895231592631784813742956","968147235341265897257983461584376912796821543132459678473598126625714389819632754","439526781612748395587391624895467132126935478374182569743219856261853947958674213","896742531451936872237158964364279185125483796789561243613895427942317658578624319","891653742756824319324719568419362875578941623632578491187495236965237184243186957","741832596635194728829675314574269183283417965196583247968351472457926831312748659","283614759956837124741952638419763285562481397378529461824196573135278946697345812","589264731163785429274193856756831294492657183831942567647529318915378642328416975","596427183213968745874351926645213879321879654789546231462795318158632497937184562"]
      this.board=[];
      this.seed="";
      this.depo=[-1,-1,0];
      this.answer="";

      this.hilight=null;
      this.focus=[-1,-1];
      this.logger;
      this.init=function(){

        this.board=new Array(81);
        var ran=this.getSeed();
        this.seed=this.seeds[ran];
        this.answer=this.answers[ran].split("").toString();
        for(var i=0;i<81;i++){
          if(this.seed.charAt(i)!=='.')this.board[i]=""+this.seed.charAt(i);
          else this.board[i]=null;
        }
        this.focus=[-1,-1];
        this.depo=[-1,-1,0];
              this.hilight=null;
      }
      this.clearBoard=function(){
        for(var i=0;i<81;i++){
          if(this.seed.charAt(i)!=='.')this.board[i]=""+this.seed.charAt(i);
          else this.board[i]=null;
        }
        this.focus=[-1,-1];
        this.depo=[-1,-1,0];
              this.hilight=null;
      }
      this.getSeed=function()
      {
        return Math.floor(Math.random()*100);//
        //return   "123456789........................................................................";
      }
      this.checkSeed=function(row,col)
      {
        return (this.seed.charAt(row*9+col)==='.');
      }
      
      this.pick=function(row,col){
        if(this.focus[0]!=row||this.focus[1]!=col){
          this.focus=[row,col];
          this.hilight=this.board[row*9+col];
        }
        else{this.focus=[-1,-1];this.hilight=null;}
      }
      this.hi=function(row,col)
      {
        this.hilight=this.board[row*9+col];
      }
      this.checkhi=function(row,col)
      {
        return (this.hilight!=null&&this.hilight===this.board[row*9+col])?"hi":this.checkmatter(row,col);
      }
      this.checkmatter=function(row,col)
      {
        if(this.focus[0]<0) return"";
        if(row==this.focus[0]||col==this.focus[1])return"matter";
        if(Math.floor(row/3)==Math.floor(this.focus[0]/3) && Math.floor(col/3)==Math.floor(this.focus[1]/3))return "matter";
        return"";
      }
      
      this.handlechange=function(row,col){
        var v=parseInt(this.board[row*9+col],10);
        if(isNaN(v)||v==0){
          this.board[row*9+col]=null;
        }
        else {
          if(v%10!==0)this.board[row*9+col]=(v%10).toString();
          else this.board[row*9+col]=(v/10).toString();
        }
        this.hi(row,col);
      }
      this.gettype=function(row,col){
        return typeof(this.board[row*9+col]);
      }
      this.finish=function()
      {
        return (this.board.toString()==this.answer);
      }
    }
  };
})


;